#include "math.hpp"
#include <array>
const double mulib::priv::sin_table[] = {
	0,
	0.00153398, 0.00306796, 0.00460193, 0.00613588, 0.00766983,
	0.00920375, 0.0107377, 0.0122715, 0.0138054, 0.0153392,
	0.016873, 0.0184067, 0.0199404, 0.0214741, 0.0230077,
	0.0245412, 0.0260747, 0.0276081, 0.0291415, 0.0306748,
	0.032208, 0.0337412, 0.0352742, 0.0368072, 0.0383401,
	0.0398729, 0.0414056, 0.0429383, 0.0444708, 0.0460032,
	0.0475355, 0.0490677, 0.0505997, 0.0521317, 0.0536635,
	0.0551952, 0.0567268, 0.0582583, 0.0597896, 0.0613207,
	0.0628518, 0.0643826, 0.0659134, 0.0674439, 0.0689743,
	0.0705046, 0.0720347, 0.0735646, 0.0750943, 0.0766239,
	0.0781532, 0.0796824, 0.0812114, 0.0827403, 0.0842689,
	0.0857973, 0.0873255, 0.0888536, 0.0903814, 0.091909,
	0.0934363, 0.0949635, 0.0964904, 0.0980171, 0.0995436,
	0.10107, 0.102596, 0.104122, 0.105647, 0.107172,
	0.108697, 0.110222, 0.111747, 0.113271, 0.114795,
	0.116319, 0.117842, 0.119365, 0.120888, 0.122411,
	0.123933, 0.125455, 0.126977, 0.128498, 0.130019,
	0.13154, 0.133061, 0.134581, 0.136101, 0.13762,
	0.139139, 0.140658, 0.142177, 0.143695, 0.145213,
	0.14673, 0.148248, 0.149765, 0.151281, 0.152797,
	0.154313, 0.155828, 0.157343, 0.158858, 0.160372,
	0.161886, 0.1634, 0.164913, 0.166426, 0.167938,
	0.16945, 0.170962, 0.172473, 0.173984, 0.175494,
	0.177004, 0.178514, 0.180023, 0.181532, 0.18304,
	0.184548, 0.186055, 0.187562, 0.189069, 0.190575,
	0.19208, 0.193586, 0.19509, 0.196595, 0.198098,
	0.199602, 0.201105, 0.202607, 0.204109, 0.20561,
	0.207111, 0.208612, 0.210112, 0.211611, 0.21311,
	0.214609, 0.216107, 0.217604, 0.219101, 0.220598,
	0.222094, 0.223589, 0.225084, 0.226578, 0.228072,
	0.229565, 0.231058, 0.23255, 0.234042, 0.235533,
	0.237024, 0.238514, 0.240003, 0.241492, 0.24298,
	0.244468, 0.245955, 0.247442, 0.248928, 0.250413,
	0.251898, 0.253382, 0.254866, 0.256349, 0.257831,
	0.259313, 0.260794, 0.262275, 0.263755, 0.265234,
	0.266713, 0.268191, 0.269668, 0.271145, 0.272621,
	0.274097, 0.275572, 0.277046, 0.27852, 0.279993,
	0.281465, 0.282937, 0.284408, 0.285878, 0.287347,
	0.288816, 0.290285, 0.291752, 0.293219, 0.294685,
	0.296151, 0.297616, 0.29908, 0.300543, 0.302006,
	0.303468, 0.304929, 0.30639, 0.30785, 0.309309,
	0.310767, 0.312225, 0.313682, 0.315138, 0.316593,
	0.318048, 0.319502, 0.320955, 0.322408, 0.323859,
	0.32531, 0.32676, 0.32821, 0.329658, 0.331106,
	0.332553, 0.334, 0.335445, 0.33689, 0.338334,
	0.339777, 0.341219, 0.342661, 0.344101, 0.345541,
	0.34698, 0.348419, 0.349856, 0.351293, 0.352729,
	0.354164, 0.355598, 0.357031, 0.358463, 0.359895,
	0.361326, 0.362756, 0.364185, 0.365613, 0.36704,
	0.368467, 0.369892, 0.371317, 0.372741, 0.374164,
	0.375586, 0.377007, 0.378428, 0.379847, 0.381266,
	0.382683, 0.3841, 0.385516, 0.386931, 0.388345,
	0.389758, 0.39117, 0.392582, 0.393992, 0.395401,
	0.39681, 0.398218, 0.399624, 0.40103, 0.402435,
	0.403838, 0.405241, 0.406643, 0.408044, 0.409444,
	0.410843, 0.412241, 0.413638, 0.415034, 0.41643,
	0.417824, 0.419217, 0.420609, 0.422, 0.42339,
	0.42478, 0.426168, 0.427555, 0.428941, 0.430326,
	0.431711, 0.433094, 0.434476, 0.435857, 0.437237,
	0.438616, 0.439994, 0.441371, 0.442747, 0.444122,
	0.445496, 0.446869, 0.448241, 0.449611, 0.450981,
	0.45235, 0.453717, 0.455084, 0.456449, 0.457813,
	0.459177, 0.460539, 0.4619, 0.46326, 0.464619,
	0.465976, 0.467333, 0.468689, 0.470043, 0.471397,
	0.472749, 0.4741, 0.47545, 0.476799, 0.478147,
	0.479494, 0.480839, 0.482184, 0.483527, 0.484869,
	0.48621, 0.48755, 0.488889, 0.490226, 0.491563,
	0.492898, 0.494232, 0.495565, 0.496897, 0.498228,
	0.499557, 0.500885, 0.502212, 0.503538, 0.504863,
	0.506187, 0.507509, 0.50883, 0.51015, 0.511469,
	0.512786, 0.514103, 0.515418, 0.516732, 0.518045,
	0.519356, 0.520666, 0.521975, 0.523283, 0.52459,
	0.525895, 0.527199, 0.528502, 0.529804, 0.531104,
	0.532403, 0.533701, 0.534998, 0.536293, 0.537587,
	0.53888, 0.540171, 0.541462, 0.542751, 0.544039,
	0.545325, 0.54661, 0.547894, 0.549177, 0.550458,
	0.551738, 0.553017, 0.554294, 0.55557, 0.556845,
	0.558119, 0.559391, 0.560662, 0.561931, 0.563199,
	0.564466, 0.565732, 0.566996, 0.568259, 0.569521,
	0.570781, 0.57204, 0.573297, 0.574553, 0.575808,
	0.577062, 0.578314, 0.579565, 0.580814, 0.582062,
	0.583309, 0.584554, 0.585798, 0.58704, 0.588282,
	0.589521, 0.59076, 0.591997, 0.593232, 0.594466,
	0.595699, 0.596931, 0.598161, 0.599389, 0.600616,
	0.601842, 0.603067, 0.60429, 0.605511, 0.606731,
	0.60795, 0.609167, 0.610383, 0.611597, 0.61281,
	0.614022, 0.615232, 0.61644, 0.617647, 0.618853,
	0.620057, 0.62126, 0.622461, 0.623661, 0.624859,
	0.626056, 0.627252, 0.628446, 0.629638, 0.630829,
	0.632019, 0.633207, 0.634393, 0.635578, 0.636762,
	0.637944, 0.639124, 0.640303, 0.641481, 0.642657,
	0.643832, 0.645005, 0.646176, 0.647346, 0.648514,
	0.649681, 0.650847, 0.652011, 0.653173, 0.654334,
	0.655493, 0.656651, 0.657807, 0.658961, 0.660114,
	0.661266, 0.662416, 0.663564, 0.664711, 0.665856,
	0.667, 0.668142, 0.669283, 0.670422, 0.671559,
	0.672695, 0.673829, 0.674962, 0.676093, 0.677222,
	0.67835, 0.679476, 0.680601, 0.681724, 0.682846,
	0.683965, 0.685084, 0.6862, 0.687315, 0.688429,
	0.689541, 0.690651, 0.691759, 0.692866, 0.693971,
	0.695075, 0.696177, 0.697278, 0.698376, 0.699473,
	0.700569, 0.701663, 0.702755, 0.703845, 0.704934,
	0.706021, 0.707107, 0.708191, 0.709273, 0.710353,
	0.711432, 0.712509, 0.713585, 0.714659, 0.715731,
	0.716801, 0.71787, 0.718937, 0.720003, 0.721066,
	0.722128, 0.723188, 0.724247, 0.725304, 0.726359,
	0.727413, 0.728464, 0.729514, 0.730563, 0.731609,
	0.732654, 0.733697, 0.734739, 0.735779, 0.736817,
	0.737853, 0.738887, 0.73992, 0.740951, 0.74198,
	0.743008, 0.744034, 0.745058, 0.74608, 0.747101,
	0.748119, 0.749136, 0.750152, 0.751165, 0.752177,
	0.753187, 0.754195, 0.755201, 0.756206, 0.757209,
	0.75821, 0.759209, 0.760207, 0.761202, 0.762196,
	0.763188, 0.764179, 0.765167, 0.766154, 0.767139,
	0.768122, 0.769103, 0.770083, 0.771061, 0.772036,
	0.77301, 0.773983, 0.774953, 0.775922, 0.776888,
	0.777853, 0.778817, 0.779778, 0.780737, 0.781695,
	0.782651, 0.783605, 0.784557, 0.785507, 0.786455,
	0.787402, 0.788346, 0.789289, 0.79023, 0.791169,
	0.792107, 0.793042, 0.793975, 0.794907, 0.795837,
	0.796765, 0.797691, 0.798615, 0.799537, 0.800458,
	0.801376, 0.802293, 0.803208, 0.80412, 0.805031,
	0.80594, 0.806848, 0.807753, 0.808656, 0.809558,
	0.810457, 0.811355, 0.812251, 0.813144, 0.814036,
	0.814926, 0.815814, 0.816701, 0.817585, 0.818467,
	0.819348, 0.820226, 0.821103, 0.821977, 0.82285,
	0.823721, 0.824589, 0.825456, 0.826321, 0.827184,
	0.828045, 0.828904, 0.829761, 0.830616, 0.83147,
	0.832321, 0.83317, 0.834018, 0.834863, 0.835706,
	0.836548, 0.837387, 0.838225, 0.83906, 0.839894,
	0.840725, 0.841555, 0.842383, 0.843208, 0.844032,
	0.844854, 0.845673, 0.846491, 0.847307, 0.84812,
	0.848932, 0.849742, 0.850549, 0.851355, 0.852159,
	0.852961, 0.85376, 0.854558, 0.855354, 0.856147,
	0.856939, 0.857729, 0.858516, 0.859302, 0.860085,
	0.860867, 0.861646, 0.862424, 0.863199, 0.863973,
	0.864744, 0.865514, 0.866281, 0.867046, 0.867809,
	0.868571, 0.86933, 0.870087, 0.870842, 0.871595,
	0.872346, 0.873095, 0.873842, 0.874587, 0.875329,
	0.87607, 0.876809, 0.877545, 0.87828, 0.879012,
	0.879743, 0.880471, 0.881197, 0.881921, 0.882643,
	0.883363, 0.884081, 0.884797, 0.885511, 0.886223,
	0.886932, 0.88764, 0.888345, 0.889048, 0.88975,
	0.890449, 0.891146, 0.891841, 0.892534, 0.893224,
	0.893913, 0.894599, 0.895284, 0.895966, 0.896646,
	0.897325, 0.898001, 0.898674, 0.899346, 0.900016,
	0.900683, 0.901349, 0.902012, 0.902673, 0.903332,
	0.903989, 0.904644, 0.905297, 0.905947, 0.906596,
	0.907242, 0.907886, 0.908528, 0.909168, 0.909806,
	0.910441, 0.911075, 0.911706, 0.912335, 0.912962,
	0.913587, 0.91421, 0.91483, 0.915449, 0.916065,
	0.916679, 0.917291, 0.917901, 0.918508, 0.919114,
	0.919717, 0.920318, 0.920917, 0.921514, 0.922109,
	0.922701, 0.923291, 0.92388, 0.924465, 0.925049,
	0.925631, 0.92621, 0.926787, 0.927363, 0.927935,
	0.928506, 0.929075, 0.929641, 0.930205, 0.930767,
	0.931327, 0.931884, 0.93244, 0.932993, 0.933544,
	0.934093, 0.934639, 0.935184, 0.935726, 0.936266,
	0.936803, 0.937339, 0.937872, 0.938404, 0.938932,
	0.939459, 0.939984, 0.940506, 0.941026, 0.941544,
	0.94206, 0.942573, 0.943084, 0.943593, 0.9441,
	0.944605, 0.945107, 0.945607, 0.946105, 0.946601,
	0.947094, 0.947586, 0.948075, 0.948561, 0.949046,
	0.949528, 0.950008, 0.950486, 0.950962, 0.951435,
	0.951906, 0.952375, 0.952842, 0.953306, 0.953768,
	0.954228, 0.954686, 0.955141, 0.955594, 0.956045,
	0.956494, 0.95694, 0.957385, 0.957826, 0.958266,
	0.958703, 0.959139, 0.959572, 0.960002, 0.960431,
	0.960857, 0.96128, 0.961702, 0.962121, 0.962538,
	0.962953, 0.963366, 0.963776, 0.964184, 0.96459,
	0.964993, 0.965394, 0.965793, 0.96619, 0.966584,
	0.966976, 0.967366, 0.967754, 0.968139, 0.968522,
	0.968903, 0.969281, 0.969657, 0.970031, 0.970403,
	0.970772, 0.971139, 0.971504, 0.971866, 0.972226,
	0.972584, 0.97294, 0.973293, 0.973644, 0.973993,
	0.974339, 0.974684, 0.975025, 0.975365, 0.975702,
	0.976037, 0.97637, 0.9767, 0.977028, 0.977354,
	0.977677, 0.977999, 0.978317, 0.978634, 0.978948,
	0.97926, 0.97957, 0.979877, 0.980182, 0.980485,
	0.980785, 0.981083, 0.981379, 0.981673, 0.981964,
	0.982253, 0.982539, 0.982824, 0.983105, 0.983385,
	0.983662, 0.983937, 0.98421, 0.98448, 0.984749,
	0.985014, 0.985278, 0.985539, 0.985798, 0.986054,
	0.986308, 0.98656, 0.986809, 0.987057, 0.987301,
	0.987544, 0.987784, 0.988022, 0.988258, 0.988491,
	0.988722, 0.98895, 0.989177, 0.9894, 0.989622,
	0.989841, 0.990058, 0.990273, 0.990485, 0.990695,
	0.990903, 0.991108, 0.991311, 0.991511, 0.99171,
	0.991906, 0.992099, 0.992291, 0.99248, 0.992666,
	0.99285, 0.993032, 0.993212, 0.993389, 0.993564,
	0.993737, 0.993907, 0.994075, 0.99424, 0.994404,
	0.994565, 0.994723, 0.994879, 0.995033, 0.995185,
	0.995334, 0.995481, 0.995625, 0.995767, 0.995907,
	0.996045, 0.99618, 0.996313, 0.996443, 0.996571,
	0.996697, 0.99682, 0.996941, 0.99706, 0.997176,
	0.99729, 0.997402, 0.997511, 0.997618, 0.997723,
	0.997825, 0.997925, 0.998023, 0.998118, 0.998211,
	0.998302, 0.99839, 0.998476, 0.998559, 0.99864,
	0.998719, 0.998795, 0.99887, 0.998941, 0.999011,
	0.999078, 0.999142, 0.999205, 0.999265, 0.999322,
	0.999378, 0.999431, 0.999481, 0.999529, 0.999575,
	0.999619, 0.99966, 0.999699, 0.999735, 0.999769,
	0.999801, 0.999831, 0.999858, 0.999882, 0.999905,
	0.999925, 0.999942, 0.999958, 0.999971, 0.999981,
	0.999989, 0.999995, 0.999999, 1};

	double mulib::sin(mulib::Angle t){
		using namespace mulib;
		using namespace mulib::priv;

		bool isMinus = false;
		if(t < MULIB_PI){
			if(t >= MULIB_RIGHT_ANGLE){
				t = Angle(MULIB_PI - t.rad());
			}																//第2象限
		}else{
			isMinus = true;
			if(t < MULIB_PI_3_2){						//第3象限
				t -= Angle(MULIB_PI);
			}else{													//第4象限
				t = Angle(MULIB_PI * 2 - t.rad());
			}
		}
		double idxDbl = t.rad() / (MULIB_RIGHT_ANGLE / sin_table_num);
		int idx = static_cast<int>(idxDbl);
		if(idxDbl - idx >= 0.5 && idx < sin_table_num){ //四捨五入
			idx++;
		}
		return ((isMinus)?(-sin_table[idx]):(sin_table[idx]));
	}

	double mulib::cos(mulib::Angle t){
		return mulib::sin(mulib::Angle(t.rad() + MULIB_RIGHT_ANGLE));
	}

	const double mulib::priv::atan_table[] = {
		0, 0.000977517, 0.00195503, 0.00293254, 0.00391005, 0.00488755, 0.00586504, 0.00684251,
		0.00781998, 0.00879743, 0.00977486, 0.0107523, 0.0117297, 0.012707, 0.0136844, 0.0146617,
		0.015639, 0.0166163, 0.0175935, 0.0185707, 0.0195479, 0.020525, 0.0215021, 0.0224791,
		0.0234561, 0.0244331, 0.02541, 0.0263868, 0.0273636, 0.0283404, 0.0293171, 0.0302938,
		0.0312704, 0.0322469, 0.0332234, 0.0341998, 0.0351761, 0.0361524, 0.0371286, 0.0381047,
		0.0390808, 0.0400568, 0.0410327, 0.0420085, 0.0429843, 0.0439599, 0.0449355, 0.045911,
		0.0468864, 0.0478618, 0.048837, 0.0498121, 0.0507872, 0.0517621, 0.052737, 0.0537117,
		0.0546864, 0.0556609, 0.0566354, 0.0576097, 0.0585839, 0.059558, 0.060532, 0.0615059,
		0.0624797, 0.0634533, 0.0644268, 0.0654002, 0.0663735, 0.0673467, 0.0683197, 0.0692926,
		0.0702654, 0.071238, 0.0722105, 0.0731829, 0.0741551, 0.0751272, 0.0760991, 0.0770709,
		0.0780425, 0.079014, 0.0799854, 0.0809566, 0.0819276, 0.0828985, 0.0838693, 0.0848398,
		0.0858103, 0.0867805, 0.0877506, 0.0887205, 0.0896903, 0.0906599, 0.0916293, 0.0925986,
		0.0935676, 0.0945365, 0.0955052, 0.0964738, 0.0974421, 0.0984103, 0.0993783, 0.100346,
		0.101314, 0.102281, 0.103248, 0.104215, 0.105182, 0.106149, 0.107115, 0.108082,
		0.109048, 0.110013, 0.110979, 0.111944, 0.11291, 0.113875, 0.11484, 0.115804,
		0.116768, 0.117733, 0.118696, 0.11966, 0.120624, 0.121587, 0.12255, 0.123513,
		0.124475, 0.125438, 0.1264, 0.127362, 0.128323, 0.129285, 0.130246, 0.131207,
		0.132167, 0.133128, 0.134088, 0.135048, 0.136008, 0.136967, 0.137926, 0.138885,
		0.139844, 0.140802, 0.14176, 0.142718, 0.143676, 0.144633, 0.14559, 0.146547,
		0.147503, 0.14846, 0.149416, 0.150371, 0.151327, 0.152282, 0.153237, 0.154192,
		0.155146, 0.1561, 0.157054, 0.158007, 0.15896, 0.159913, 0.160866, 0.161818,
		0.16277, 0.163722, 0.164673, 0.165624, 0.166575, 0.167525, 0.168476, 0.169426,
		0.170375, 0.171324, 0.172273, 0.173222, 0.17417, 0.175118, 0.176066, 0.177013,
		0.17796, 0.178907, 0.179853, 0.1808, 0.181745, 0.182691, 0.183636, 0.184581,
		0.185525, 0.186469, 0.187413, 0.188356, 0.189299, 0.190242, 0.191184, 0.192127,
		0.193068, 0.19401, 0.194951, 0.195891, 0.196832, 0.197771, 0.198711, 0.19965,
		0.200589, 0.201528, 0.202466, 0.203404, 0.204341, 0.205278, 0.206215, 0.207151,
		0.208087, 0.209023, 0.209958, 0.210893, 0.211828, 0.212762, 0.213695, 0.214629,
		0.215562, 0.216494, 0.217427, 0.218358, 0.21929, 0.220221, 0.221152, 0.222082,
		0.223012, 0.223941, 0.22487, 0.225799, 0.226727, 0.227655, 0.228583, 0.22951,
		0.230437, 0.231363, 0.232289, 0.233214, 0.23414, 0.235064, 0.235989, 0.236912,
		0.237836, 0.238759, 0.239682, 0.240604, 0.241526, 0.242447, 0.243368, 0.244289,
		0.245209, 0.246128, 0.247048, 0.247966, 0.248885, 0.249803, 0.25072, 0.251638,
		0.252554, 0.253471, 0.254386, 0.255302, 0.256217, 0.257131, 0.258045, 0.258959,
		0.259872, 0.260785, 0.261697, 0.262609, 0.26352, 0.264431, 0.265342, 0.266252,
		0.267162, 0.268071, 0.26898, 0.269888, 0.270796, 0.271703, 0.27261, 0.273516,
		0.274422, 0.275328, 0.276233, 0.277137, 0.278041, 0.278945, 0.279848, 0.280751,
		0.281653, 0.282555, 0.283456, 0.284357, 0.285257, 0.286157, 0.287057, 0.287956,
		0.288854, 0.289752, 0.290649, 0.291546, 0.292443, 0.293339, 0.294235, 0.29513,
		0.296024, 0.296918, 0.297812, 0.298705, 0.299598, 0.30049, 0.301381, 0.302272,
		0.303163, 0.304053, 0.304943, 0.305832, 0.306721, 0.307609, 0.308497, 0.309384,
		0.31027, 0.311156, 0.312042, 0.312927, 0.313812, 0.314696, 0.31558, 0.316463,
		0.317345, 0.318227, 0.319109, 0.31999, 0.320871, 0.321751, 0.32263, 0.323509,
		0.324388, 0.325265, 0.326143, 0.32702, 0.327896, 0.328772, 0.329647, 0.330522,
		0.331397, 0.33227, 0.333144, 0.334016, 0.334888, 0.33576, 0.336631, 0.337502,
		0.338372, 0.339241, 0.34011, 0.340979, 0.341847, 0.342714, 0.343581, 0.344447,
		0.345313, 0.346179, 0.347043, 0.347907, 0.348771, 0.349634, 0.350497, 0.351359,
		0.35222, 0.353081, 0.353941, 0.354801, 0.35566, 0.356519, 0.357377, 0.358235,
		0.359092, 0.359949, 0.360804, 0.36166, 0.362515, 0.363369, 0.364223, 0.365076,
		0.365929, 0.366781, 0.367632, 0.368483, 0.369334, 0.370184, 0.371033, 0.371882,
		0.37273, 0.373577, 0.374424, 0.375271, 0.376117, 0.376962, 0.377807, 0.378651,
		0.379495, 0.380338, 0.38118, 0.382022, 0.382864, 0.383704, 0.384545, 0.385384,
		0.386223, 0.387062, 0.3879, 0.388737, 0.389574, 0.39041, 0.391246, 0.392081,
		0.392916, 0.39375, 0.394583, 0.395416, 0.396248, 0.397079, 0.39791, 0.398741,
		0.399571, 0.4004, 0.401229, 0.402057, 0.402884, 0.403711, 0.404538, 0.405364,
		0.406189, 0.407013, 0.407837, 0.408661, 0.409484, 0.410306, 0.411128, 0.411949,
		0.412769, 0.413589, 0.414409, 0.415227, 0.416045, 0.416863, 0.41768, 0.418496,
		0.419312, 0.420127, 0.420942, 0.421756, 0.422569, 0.423382, 0.424194, 0.425006,
		0.425817, 0.426627, 0.427437, 0.428247, 0.429055, 0.429863, 0.430671, 0.431478,
		0.432284, 0.433089, 0.433894, 0.434699, 0.435503, 0.436306, 0.437109, 0.437911,
		0.438712, 0.439513, 0.440313, 0.441113, 0.441912, 0.44271, 0.443508, 0.444305,
		0.445102, 0.445898, 0.446693, 0.447488, 0.448282, 0.449076, 0.449869, 0.450661,
		0.451453, 0.452244, 0.453035, 0.453825, 0.454614, 0.455403, 0.456191, 0.456978,
		0.457765, 0.458552, 0.459337, 0.460122, 0.460907, 0.461691, 0.462474, 0.463257,
		0.464039, 0.46482, 0.465601, 0.466381, 0.46716, 0.467939, 0.468718, 0.469495,
		0.470273, 0.471049, 0.471825, 0.4726, 0.473375, 0.474149, 0.474922, 0.475695,
		0.476467, 0.477239, 0.47801, 0.47878, 0.47955, 0.480319, 0.481088, 0.481856,
		0.482623, 0.48339, 0.484156, 0.484921, 0.485686, 0.48645, 0.487214, 0.487977,
		0.488739, 0.489501, 0.490262, 0.491022, 0.491782, 0.492541, 0.4933, 0.494058,
		0.494815, 0.495572, 0.496328, 0.497084, 0.497839, 0.498593, 0.499347, 0.5001,
		0.500852, 0.501604, 0.502355, 0.503106, 0.503856, 0.504605, 0.505354, 0.506102,
		0.506849, 0.507596, 0.508343, 0.509088, 0.509833, 0.510578, 0.511321, 0.512065,
		0.512807, 0.513549, 0.51429, 0.515031, 0.515771, 0.51651, 0.517249, 0.517987,
		0.518725, 0.519462, 0.520198, 0.520934, 0.521669, 0.522403, 0.523137, 0.52387,
		0.524603, 0.525335, 0.526066, 0.526797, 0.527527, 0.528257, 0.528986, 0.529714,
		0.530442, 0.531169, 0.531895, 0.532621, 0.533346, 0.53407, 0.534794, 0.535518,
		0.53624, 0.536962, 0.537684, 0.538405, 0.539125, 0.539844, 0.540563, 0.541282,
		0.541999, 0.542716, 0.543433, 0.544149, 0.544864, 0.545579, 0.546293, 0.547006,
		0.547719, 0.548431, 0.549142, 0.549853, 0.550563, 0.551273, 0.551982, 0.552691,
		0.553398, 0.554106, 0.554812, 0.555518, 0.556223, 0.556928, 0.557632, 0.558336,
		0.559039, 0.559741, 0.560442, 0.561143, 0.561844, 0.562544, 0.563243, 0.563941,
		0.564639, 0.565336, 0.566033, 0.566729, 0.567425, 0.56812, 0.568814, 0.569507,
		0.5702, 0.570893, 0.571584, 0.572276, 0.572966, 0.573656, 0.574345, 0.575034,
		0.575722, 0.57641, 0.577096, 0.577783, 0.578468, 0.579153, 0.579838, 0.580521,
		0.581205, 0.581887, 0.582569, 0.58325, 0.583931, 0.584611, 0.585291, 0.58597,
		0.586648, 0.587326, 0.588003, 0.588679, 0.589355, 0.59003, 0.590705, 0.591379,
		0.592052, 0.592725, 0.593397, 0.594069, 0.59474, 0.59541, 0.59608, 0.596749,
		0.597417, 0.598085, 0.598752, 0.599419, 0.600085, 0.600751, 0.601416, 0.60208,
		0.602744, 0.603407, 0.604069, 0.604731, 0.605392, 0.606053, 0.606713, 0.607372,
		0.608031, 0.608689, 0.609347, 0.610004, 0.61066, 0.611316, 0.611971, 0.612626,
		0.61328, 0.613933, 0.614586, 0.615238, 0.61589, 0.616541, 0.617191, 0.617841,
		0.61849, 0.619139, 0.619787, 0.620434, 0.621081, 0.621727, 0.622373, 0.623018,
		0.623662, 0.624306, 0.624949, 0.625592, 0.626234, 0.626876, 0.627516, 0.628157,
		0.628796, 0.629435, 0.630074, 0.630712, 0.631349, 0.631986, 0.632622, 0.633257,
		0.633892, 0.634526, 0.63516, 0.635793, 0.636426, 0.637058, 0.637689, 0.63832,
		0.63895, 0.63958, 0.640209, 0.640837, 0.641465, 0.642092, 0.642719, 0.643345,
		0.64397, 0.644595, 0.645219, 0.645843, 0.646466, 0.647089, 0.647711, 0.648332,
		0.648953, 0.649573, 0.650193, 0.650812, 0.65143, 0.652048, 0.652665, 0.653282,
		0.653898, 0.654514, 0.655128, 0.655743, 0.656357, 0.65697, 0.657583, 0.658195,
		0.658806, 0.659417, 0.660027, 0.660637, 0.661246, 0.661855, 0.662463, 0.66307,
		0.663677, 0.664283, 0.664889, 0.665494, 0.666099, 0.666703, 0.667306, 0.667909,
		0.668511, 0.669113, 0.669714, 0.670315, 0.670915, 0.671514, 0.672113, 0.672711,
		0.673309, 0.673906, 0.674502, 0.675098, 0.675694, 0.676289, 0.676883, 0.677477,
		0.67807, 0.678662, 0.679255, 0.679846, 0.680437, 0.681027, 0.681617, 0.682206,
		0.682795, 0.683383, 0.68397, 0.684557, 0.685144, 0.68573, 0.686315, 0.686899,
		0.687484, 0.688067, 0.68865, 0.689233, 0.689815, 0.690396, 0.690977, 0.691557,
		0.692137, 0.692716, 0.693294, 0.693872, 0.69445, 0.695027, 0.695603, 0.696179,
		0.696754, 0.697329, 0.697903, 0.698476, 0.699049, 0.699622, 0.700194, 0.700765,
		0.701336, 0.701906, 0.702476, 0.703045, 0.703614, 0.704182, 0.704749, 0.705316,
		0.705883, 0.706449, 0.707014, 0.707579, 0.708143, 0.708707, 0.70927, 0.709833,
		0.710395, 0.710956, 0.711517, 0.712078, 0.712637, 0.713197, 0.713756, 0.714314,
		0.714872, 0.715429, 0.715986, 0.716542, 0.717097, 0.717652, 0.718207, 0.718761,
		0.719314, 0.719867, 0.720419, 0.720971, 0.721523, 0.722073, 0.722624, 0.723173,
		0.723722, 0.724271, 0.724819, 0.725367, 0.725914, 0.72646, 0.727006, 0.727552,
		0.728097, 0.72841, 0.729185, 0.729728, 0.730271, 0.730813, 0.731355, 0.731896,
		0.732437, 0.732977, 0.733517, 0.734056, 0.734594, 0.735133, 0.73567, 0.736207,
		0.736744, 0.73728, 0.737815, 0.73835, 0.738884, 0.739418, 0.739952, 0.740485,
		0.741017, 0.741549, 0.74208, 0.742611, 0.743141, 0.743671, 0.7442, 0.744729,
		0.745257, 0.745785, 0.746312, 0.746839, 0.747365, 0.74789, 0.748416, 0.74894,
		0.749464, 0.749988, 0.750511, 0.751034, 0.751556, 0.752077, 0.752598, 0.753119,
		0.753639, 0.754158, 0.754677, 0.755196, 0.755714, 0.756231, 0.756748, 0.757265,
		0.757781, 0.758296, 0.758811, 0.759326, 0.75984, 0.760353, 0.760866, 0.761379,
		0.761891, 0.762402, 0.762913, 0.763424, 0.763934, 0.764443, 0.764952, 0.765461,
		0.765969, 0.766476, 0.766983, 0.76749, 0.767996, 0.768501, 0.769006, 0.769511,
		0.770015, 0.770518, 0.771021, 0.771524, 0.772026, 0.772528, 0.773029, 0.773529,
		0.774029, 0.774529, 0.775028, 0.775527, 0.776025, 0.776523, 0.77702, 0.777517,
		0.778013, 0.778509, 0.779004, 0.779499, 0.779993, 0.780487, 0.78098, 0.781473,
		0.781965, 0.782457, 0.782948, 0.783439, 0.78393, 0.78442, 0.784909, 0.785398
	};

	//This 'atan2' function is originally written by ArGxento. Thanks!
	mulib::Angle mulib::atan2(double y, double x){
		using namespace mulib;
		using namespace mulib::priv;
		const bool IsXMinus = (x < 0) ? true : false; //xは負か？
		const bool IsYMinus = (y < 0) ? true : false; //yは負か？

		if(x == 0 && y == 0){
			return Angle(0);
		}else if(x == 0){
			return ((IsYMinus == true) ? Angle() : Angle(MULIB_RIGHT_ANGLE));
		}else if(y == 0){
			return ((IsXMinus == true) ? Angle(MULIB_PI) : Angle(0));
		}
		const double absX = x * ((IsXMinus == true) ? -1: 1);
		const double absY = y * ((IsYMinus == true) ? -1: 1);

		const int flag =
			((IsXMinus == true) ? 4: 0) | ((IsYMinus == true) ? 2: 0) | ((absY >= absX) ? 1: 0);
		//p(flag);
		/*
		flag:
		 \5 y 1/
		4 \ | / 0
		----+----x
		6 / | \ 2
		 /7 | 3\
		*/
		const double hvRatio =
			((flag & 1 )?(((double)absX) / ((double)absY)):(((double)absY) / ((double)absX)));
		double TableIdxDbl = hvRatio * (double)(atan_table_num - 1);
		int table_idx = (int)(TableIdxDbl);

		if(TableIdxDbl - table_idx>=0.5){ //四捨五入
			table_idx++;
		}
		const double th = atan_table[table_idx];

		switch(flag){
			case 0: return Angle(th);
			case 1: return Angle(MULIB_RIGHT_ANGLE - th);
			case 2: return Angle(MULIB_PI * 2.0 - th);
			case 3: return Angle( + th);
			case 4: return Angle(MULIB_PI - th);
			case 5: return Angle(MULIB_RIGHT_ANGLE + th);
			case 6: return Angle(MULIB_PI + th);
			case 7: return Angle( - th);
		}
		return Angle(0);
	}
	mulib::Angle mulib::atan2(Vec2D<double> vec){
		return mulib::atan2(vec.y(),vec.x());
	}

	/*!===========================================================================
		** 2次ベジェ曲線を求める(座標のみ)
	============================================================================*/
	template<typename T>
	mulib::Vec2D mulib::Get2DBezier(const mulib::Vec2D<T>& startPos,
																	const mulib::Vec2D<T>& endPos,
																	const mulib::Vec2D<T>& ctrlPos,
																	const int divNum, const int nowPhase){
		using namespace mulib;
		if(divNum <= 0 || nowPhase > DivNum){
			return Vec2D<T>(0);
		}
		const double u = ( 1.0 / divNum ) * nowPhase;
		const Vec2D<double> psm = (1-u) * startPos + u * ctrlPos;
		const Vec2D<double> pme = (1-u) * ctrlPos + u * endPos;
		return Vec2D<T>(static_cast<T>((1-u) * psm.x() + u * pme.x()),
										static_cast<T>((1-u) * psm.y() + u * pme.y()));
	}

	/*!===========================================================================
		** 2次ベジェ曲線を求める(中心座標・角度・長さスカラ)
	============================================================================*/
	template<typename T>
	void mulib::Get2DBezier(const mulib::Vec2D<T>& startPos,
													const mulib::Vec2D<T>& endPos,
													const mulib::Vec2D<T>& ctrlPos,
													const int divNum, const int nowPhase,
													mulib::Vec2D<T>* rtnPosPtr,
													double* rtnVelPtr,
													mulib::Angle* rtnRadPtr){

		using namespace mulib;
		//分割数が0または現在の段階が分割数を超えていたら
		if(divNum <= 0 || nowPhase > DivNum){
			if(rtnPosPtr != nullptr){*rtnPosPtr = Vec2D<T>(0);}
			if(rtnVelPtr != nullptr){*rtnVelPtr = Vec2D<double>(0);}
			if(rtnRadPtr != nullptr){*rtnRadPtr = Angle(0);}
			return;
		}

		std::array<Vec2D<T>,2> edge;
		for(int i=0;i<2;i++){ //上端と下端計算
			//2次ベジェ曲線本体
			edge[i] = Get2DBezier<T>(startPos,endPos,ctrlPos,divNum+1,nowPhase+(1-i));
		}
		Vec2D<double> rtn((edge[0] + edge[1]) / 2);
		if(rtnPosPtr != nullptr){*rtnPosPtr = static_cast<T>(rtn);}
		if(rtnRadPtr != nullptr){*rtnRadPtr = atan2(rtn);} //角度算出
		if(rtnVelPtr != nullptr){ //距離算出
			*rtnVelPtr = std::sqrt(std::pow((rtn.x() - edge[0].x()),2) +
														 std::pow((rtn.y() - edge[0].y()),2));
		}
		return;
	 }
